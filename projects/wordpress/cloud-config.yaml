#cloud-config
package_update: true
packages:
  - bash-completion
  - unzip
users:
  - name: drew
    sudo: ['ALL=(ALL) NOPASSWD:ALL']
    groups: [sudo, www-data]
    shell: /bin/bash
    lock_passwd: false
    passwd: $6$rounds=4096$nQEeaHtrjiUlxOPi$LQlgi0XBR6u46AJFhWxsWBBK8YqHbGWYWkWnG.YhmdYkc/lMiAacMwQAbZ0W7MosLFexushHQpfa05eG7gsL/1
    ssh-authorized-keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCX3ZnnojSpqi1R7CWmP7uVFU2fEd2uS4PYQpWC23ScmDGP7KFHeTJfMc6eMaAhbxfIXx2CFdsIhP5U58BFLmAxkUIM8lGnHgh1uME/aOMZokZrDhYnw0eaamVOg0rdKD/uaTo87ASoxpf0XYnrqcrYhFIQodxjsCC8pCU5Egjh9QDgHsniJ5vWEkxZGPQ4SXIj4txh8uXMI0mh57BWJRK0zJIDzZCxubtrOpWoQnVvg/ZV+Thgy0P9m7e8OHbaM3U/7p4DBd1MZ95jNwjefMeD5hR46T35rkR9w/ebEIKhGjz0UB2yRUZPOPqBzVfixYA6gfd5c1AhjluCyCqhLEMd Generated-by-Nova
  - name: wordpress
    sudo: false
    groups: [www-data]
    shell: /bin/bash
    lock_passwd: false
write_files:
  - path: /etc/ssh/sshd_config
    content: |
      Port 1355
      PermitRootLogin no
      PasswordAuthentication yes
    append: true
    permissions: 600
  - path: /tmp/lemp-install.sh
    encoding: base64
    permissions: 700
    content: |-
      IyEvYmluL2Jhc2gKCnNldCAtZQoKRE9NQUlOPSJkZWZhdWx0IgoKIyBJbnN0YWxsIHBhY2thZ2VzCmFwdCB1cGRhdGUKYXB0IGluc3RhbGwgLXkgbmdpbnggbWFyaWFkYi1zZXJ2ZXIgcGhwLWZwbSBwaHAtbXlzcWwgcGhwLWN1cmwgcGhwLWdkIHBocC1pbnRsIHBocC1tYnN0cmluZyBwaHAtc29hcCBwaHAteG1sIHBocC14bWxycGMgcGhwLXppcAoKIyBDb25maWd1cmUgbWFyaWFkYgojIG15c3FsX3NlY3VyZV9pbnN0YWxsYXRpb24KIyBtYXJpYWRiIC11IHdwLXVzZXIgLXAKCiMgQ29uZmlndXJlIG5naW54Cm1rZGlyIC92YXIvd3d3LyRET01BSU4KY2hvd24gLVIgd29yZHByZXNzOndvcmRwcmVzcyAvdmFyL3d3dy8kRE9NQUlOCnRvdWNoIC9ldGMvbmdpbngvc2l0ZXMtYXZhaWxhYmxlLyRET01BSU4KZWNobyAiIyBnZW5lcmF0ZWQgMjAyMy0wNS0yOSwgTW96aWxsYSBHdWlkZWxpbmUgdjUuNywgbmdpbnggMS4xNy43LCBPcGVuU1NMIDEuMS4xaywgaW50ZXJtZWRpYXRlIGNvbmZpZ3VyYXRpb24KIyBodHRwczovL3NzbC1jb25maWcubW96aWxsYS5vcmcvI3NlcnZlcj1uZ2lueCZ2ZXJzaW9uPTEuMTcuNyZjb25maWc9aW50ZXJtZWRpYXRlJm9wZW5zc2w9MS4xLjFrJmd1aWRlbGluZT01LjcKc2VydmVyIHsKICAgICAgICBsaXN0ZW4gODA7CiAgICAgICAgbGlzdGVuIFs6Ol06ODA7CgogICAgICAgIHJvb3QgL3Zhci93d3cvJERPTUFJTjsKICAgICAgICBpbmRleCBpbmRleC5waHAgaW5kZXguaHRtbCBpbmRleC5odG07CgogICAgICAgIHNlcnZlcl9uYW1lICRET01BSU47CgogICAgICAgIGxvY2F0aW9uIC8gewogICAgICAgICAgICB0cnlfZmlsZXMgJHVyaSAkdXJpLyA9NDA0OwogICAgICAgIH0KCiAgICAgICAgbG9jYXRpb24gfiBcLnBocCQgewogICAgICAgICAgICBpbmNsdWRlIHNuaXBwZXRzL2Zhc3RjZ2ktcGhwLmNvbmY7CiAgICAgICAgICAgIGZhc3RjZ2lfcGFzcyB1bml4Oi92YXIvcnVuL3BocC9waHA3LjMtZnBtLnNvY2s7CiAgICAgICAgfQogICAgfQoKIyBzZXJ2ZXIgewojICAgICBsaXN0ZW4gNDQzIHNzbCBodHRwMjsKIyAgICAgbGlzdGVuIFs6Ol06NDQzIHNzbCBodHRwMjsKCiMgICAgIHNzbF9jZXJ0aWZpY2F0ZSAvcGF0aC90by9zaWduZWRfY2VydF9wbHVzX2ludGVybWVkaWF0ZXM7CiMgICAgIHNzbF9jZXJ0aWZpY2F0ZV9rZXkgL3BhdGgvdG8vcHJpdmF0ZV9rZXk7CiMgICAgIHNzbF9zZXNzaW9uX3RpbWVvdXQgMWQ7CiMgICAgIHNzbF9zZXNzaW9uX2NhY2hlIHNoYXJlZDpNb3pTU0w6MTBtOyAgIyBhYm91dCA0MDAwMCBzZXNzaW9ucwojICAgICBzc2xfc2Vzc2lvbl90aWNrZXRzIG9mZjsKCiMgICAgICMgY3VybCBodHRwczovL3NzbC1jb25maWcubW96aWxsYS5vcmcvZmZkaGUyMDQ4LnR4dCA+IC9wYXRoL3RvL2RocGFyYW0KIyAgICAgc3NsX2RocGFyYW0gL3BhdGgvdG8vZGhwYXJhbTsKCiMgICAgICMgaW50ZXJtZWRpYXRlIGNvbmZpZ3VyYXRpb24KIyAgICAgc3NsX3Byb3RvY29scyBUTFN2MS4yIFRMU3YxLjM7CiMgICAgIHNzbF9jaXBoZXJzIEVDREhFLUVDRFNBLUFFUzEyOC1HQ00tU0hBMjU2OkVDREhFLVJTQS1BRVMxMjgtR0NNLVNIQTI1NjpFQ0RIRS1FQ0RTQS1BRVMyNTYtR0NNLVNIQTM4NDpFQ0RIRS1SU0EtQUVTMjU2LUdDTS1TSEEzODQ6RUNESEUtRUNEU0EtQ0hBQ0hBMjAtUE9MWTEzMDU6RUNESEUtUlNBLUNIQUNIQTIwLVBPTFkxMzA1OkRIRS1SU0EtQUVTMTI4LUdDTS1TSEEyNTY6REhFLVJTQS1BRVMyNTYtR0NNLVNIQTM4NDpESEUtUlNBLUNIQUNIQTIwLVBPTFkxMzA1OwojICAgICBzc2xfcHJlZmVyX3NlcnZlcl9jaXBoZXJzIG9mZjsKCiMgICAgICMgSFNUUyAobmd4X2h0dHBfaGVhZGVyc19tb2R1bGUgaXMgcmVxdWlyZWQpICg2MzA3MjAwMCBzZWNvbmRzKQojICAgICBhZGRfaGVhZGVyIFN0cmljdC1UcmFuc3BvcnQtU2VjdXJpdHkgIm1heC1hZ2U9NjMwNzIwMDAiIGFsd2F5czsKCiMgICAgICMgT0NTUCBzdGFwbGluZwojICAgICBzc2xfc3RhcGxpbmcgb247CiMgICAgIHNzbF9zdGFwbGluZ192ZXJpZnkgb247CgojICAgICAjIHZlcmlmeSBjaGFpbiBvZiB0cnVzdCBvZiBPQ1NQIHJlc3BvbnNlIHVzaW5nIFJvb3QgQ0EgYW5kIEludGVybWVkaWF0ZSBjZXJ0cwojICAgICBzc2xfdHJ1c3RlZF9jZXJ0aWZpY2F0ZSAvcGF0aC90by9yb290X0NBX2NlcnRfcGx1c19pbnRlcm1lZGlhdGVzOwoKIyAgICAgIyByZXBsYWNlIHdpdGggdGhlIElQIGFkZHJlc3Mgb2YgeW91ciByZXNvbHZlcgojICAgICByZXNvbHZlciAxMjcuMC4wLjE7CiMgfSIgPiAvZXRjL25naW54L3NpdGVzLWF2YWlsYWJsZS8kRE9NQUlOCmxuIC1zIC9ldGMvbmdpbngvc2l0ZXMtYXZhaWxhYmxlLyRET01BSU4gL2V0Yy9uZ2lueC9zaXRlcy1lbmFibGVkLyRET01BSU4gfHwgdHJ1ZSAjVE9ETyBtYWtlIHN1cmUgdGhpcyBpc24ndCBhIGJhZCBpZGVhCm5naW54IC10CnN5c3RlbWN0bCByZWxvYWQgbmdpbngKCiMgSW5zdGFsbCB3b3JkcHJlc3MKcm0gLXJmIC92YXIvd3d3L2h0bWwvKgp3Z2V0IC1QIC9ob21lL3dvcmRwcmVzcyBodHRwczovL3dvcmRwcmVzcy5vcmcvbGF0ZXN0LnppcAp1bnppcCAvaG9tZS93b3JkcHJlc3MvbGF0ZXN0LnppcCAtZCAvdmFyL3d3dy8kRE9NQUlOCgojIEZpeCBmb2xkZXIgcGVybWlzc2lvbnMKY2htb2QgNzU1IC1SIC92YXIvd3d3LwpjaG93biB3b3JkcHJlc3MgLVIgL3Zhci93d3cv
runcmd:
  - cp /etc/skel/.bashrc /home/drew/.profile
  - sed -i 's/#force_color_prompt=yes/force_color_prompt=yes/g' /home/drew/.profile
  - chown drew:drew /home/drew/.profile
  - systemctl restart ssh
  - /tmp/lemp-install.sh
