#cloud-config
package_update: true
packages:
  - bash-completion
  - unzip
users:
  - name: drew
    sudo: ['ALL=(ALL) NOPASSWD:ALL']
    groups: [sudo, www-data]
    shell: /bin/bash
    lock_passwd: false
    passwd: $6$rounds=4096$nQEeaHtrjiUlxOPi$LQlgi0XBR6u46AJFhWxsWBBK8YqHbGWYWkWnG.YhmdYkc/lMiAacMwQAbZ0W7MosLFexushHQpfa05eG7gsL/1
    ssh-authorized-keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCX3ZnnojSpqi1R7CWmP7uVFU2fEd2uS4PYQpWC23ScmDGP7KFHeTJfMc6eMaAhbxfIXx2CFdsIhP5U58BFLmAxkUIM8lGnHgh1uME/aOMZokZrDhYnw0eaamVOg0rdKD/uaTo87ASoxpf0XYnrqcrYhFIQodxjsCC8pCU5Egjh9QDgHsniJ5vWEkxZGPQ4SXIj4txh8uXMI0mh57BWJRK0zJIDzZCxubtrOpWoQnVvg/ZV+Thgy0P9m7e8OHbaM3U/7p4DBd1MZ95jNwjefMeD5hR46T35rkR9w/ebEIKhGjz0UB2yRUZPOPqBzVfixYA6gfd5c1AhjluCyCqhLEMd Generated-by-Nova
  - name: wordpress
    sudo: false
    groups: [www-data]
    shell: /bin/bash
    lock_passwd: false
write_files:
  - path: "/etc/environment"
    content: "ZXhwb3J0IFBBU1NfTVlTUUxfUk9PVD1hc2RmYXNkZgpleHBvcnQgUEFTU19NWVNRTF9XUF9VU0VSPWFzZGZhc2RmCmV4cG9ydCBQQVNTX1dPUkRQUkVTUz1hc2RmYXNkZgo="
    encoding: base64
    append: true
  - path: "/etc/ssh/sshd_config"
    content: "UG9ydCAxMzU1ClBlcm1pdFJvb3RMb2dpbiBubwpQYXNzd29yZEF1dGhlbnRpY2F0aW9uIHllcwo="
    append: true
    encoding: base64
  - path: "/etc/lemp-install.sh"
    encoding: base64
    permissions: "700"
    content: IyEvYmluL2Jhc2gKCnNldCAtZQoKIyBkZWZhdWx0IG5vbmUKRE9NQUlOX09SX05PTkU9CiMgZGVmYXVsdCAiZGVmYXVsdCIKRE9NQUlOX09SX0RFRkFVTFQ9ImRlZmF1bHQiCgojIEluc3RhbGwgcGFja2FnZXMKYXB0IHVwZGF0ZSB8fCB0cnVlCmFwdCBpbnN0YWxsIC15IG5naW54IG1hcmlhZGItc2VydmVyIHBocC1mcG0gcGhwLW15c3FsIHBocC1jdXJsIHBocC1nZCBwaHAtaW50bCBwaHAtbWJzdHJpbmcgcGhwLXNvYXAgcGhwLXhtbCBwaHAteG1scnBjIHBocC16aXAKCiMgQ29uZmlndXJlIG1hcmlhZGIKc3lzdGVtY3RsIHN0b3AgbXlzcWwKa2lsbGFsbCAtOSBteXNxbGRfc2FmZSBteXNxbGQgbWFyaWFkYiBtYXJpYWRiZCBteXNxbCB8fCB0cnVlCmVjaG8gIkRpc2FibGluZyBncmFudCB0YWJsZXMgYW5kIG5ldHdvcmtpbmciCm15c3FsZF9zYWZlIC0tc2tpcC1ncmFudC10YWJsZXMgLS1za2lwLW5ldHdvcmtpbmcgJj4vZGV2L251bGwgJiBkaXNvd24KZWNobyAiV2FpdGluZyBmb3IgbXlzcWwgdG8gc3RhcnQiCnNsZWVwIDEwCm15c3FsIC11cm9vdCAtZSAiRkxVU0ggUFJJVklMRUdFUzsgQUxURVIgVVNFUiAncm9vdCdAJ2xvY2FsaG9zdCcgSURFTlRJRklFRCBCWSAnJFBBU1NfTVlTUUxfUk9PVCc7ICIKa2lsbGFsbCAtOSBteXNxbGRfc2FmZSBtYXJpYWRiZCB8fCB0cnVlCmVjaG8gIlJlc3RhcnRpbmcgbXlzcWwiCnN5c3RlbWN0bCBzdGFydCBteXNxbAoKbXlzcWwgLS11c2VyPXJvb3QgLS1wYXNzd29yZD0ke1BBU1NfTVlTUUxfUk9PVH0gLWUgIgpERUxFVEUgRlJPTSBteXNxbC51c2VyIFdIRVJFIFVzZXI9J3Jvb3QnIEFORCBIb3N0IE5PVCBJTiAoJ2xvY2FsaG9zdCcsICcxMjcuMC4wLjEnLCAnOjoxJyk7CkRFTEVURSBGUk9NIG15c3FsLnVzZXIgV0hFUkUgVXNlcj0nJzsKREVMRVRFIEZST00gbXlzcWwuZGIgV0hFUkUgRGI9J3Rlc3QnIE9SIERiPSd0ZXN0XyUnOwpDUkVBVEUgVVNFUiAnd29yZHByZXNzdXNlcidAJ2xvY2FsaG9zdCcgSURFTlRJRklFRCBCWSAnJHtQQVNTX01ZU1FMX1dQX1VTRVJ9JzsKQ1JFQVRFIERBVEFCQVNFIHdvcmRwcmVzcyBERUZBVUxUIENIQVJBQ1RFUiBTRVQgdXRmOCBDT0xMQVRFIHV0ZjhfdW5pY29kZV9jaTsKR1JBTlQgQUxMIE9OIHdvcmRwcmVzcy4qIFRPICd3b3JkcHJlc3N1c2VyJ0AnbG9jYWxob3N0JzsKRkxVU0ggUFJJVklMRUdFUzsgIgoKIyBDb25maWd1cmUgcGhwCnN5c3RlbWN0bCByZXN0YXJ0IHBocDcuNC1mcG0KCiMgQ29uZmlndXJlIG5naW54Cm1rZGlyIC1wIC92YXIvd3d3LyRET01BSU5fT1JfTk9ORSAKY2hvd24gLVIgd29yZHByZXNzOndvcmRwcmVzcyAvdmFyL3d3dy8kRE9NQUlOX09SX05PTkUKdG91Y2ggL2V0Yy9uZ2lueC9zaXRlcy1hdmFpbGFibGUvJERPTUFJTl9PUl9ERUZBVUxUCmVjaG8gIiMgZ2VuZXJhdGVkIDIwMjMtMDUtMjksIE1vemlsbGEgR3VpZGVsaW5lIHY1LjcsIG5naW54IDEuMTcuNywgT3BlblNTTCAxLjEuMWssIGludGVybWVkaWF0ZSBjb25maWd1cmF0aW9uCiMgaHR0cHM6Ly9zc2wtY29uZmlnLm1vemlsbGEub3JnLyNzZXJ2ZXI9bmdpbngmdmVyc2lvbj0xLjE3LjcmY29uZmlnPWludGVybWVkaWF0ZSZvcGVuc3NsPTEuMS4xayZndWlkZWxpbmU9NS43CnNlcnZlciB7CiAgICBsaXN0ZW4gODA7CiAgICBsaXN0ZW4gWzo6XTo4MDsKCiAgICByb290IC92YXIvd3d3LyRET01BSU5fT1JfTk9ORTsKICAgIGluZGV4IGluZGV4LnBocCBpbmRleC5odG1sIGluZGV4Lmh0bTsKCiAgICBzZXJ2ZXJfbmFtZSAkRE9NQUlOX09SX0RFRkFVTFQ7CgogICAgbG9jYXRpb24gLyB7CiAgICAgICAgIyB0cnlfZmlsZXMgJHVyaSAkdXJpLyA9NDA0OwogICAgICAgIHRyeV9maWxlcyAkdXJpICR1cmkvIC9pbmRleC5waHAkaXNfYXJncyRhcmdzOwogICAgfQoKICAgIGxvY2F0aW9uIH4gXC5waHAkIHsKICAgICAgICBpbmNsdWRlIHNuaXBwZXRzL2Zhc3RjZ2ktcGhwLmNvbmY7CiAgICAgICAgZmFzdGNnaV9wYXNzIHVuaXg6L3Zhci9ydW4vcGhwL3BocDcuNC1mcG0uc29jazsKICAgIH0KCiAgICAjIERpZ2l0YWxvY2VhbiB3b3JkcHJlc3MKICAgIGxvY2F0aW9uID0gL2Zhdmljb24uaWNvIHsgbG9nX25vdF9mb3VuZCBvZmY7IGFjY2Vzc19sb2cgb2ZmOyB9CiAgICBsb2NhdGlvbiA9IC9yb2JvdHMudHh0IHsgbG9nX25vdF9mb3VuZCBvZmY7IGFjY2Vzc19sb2cgb2ZmOyBhbGxvdyBhbGw7IH0KICAgIGxvY2F0aW9uIH4qIFwuKGNzc3xnaWZ8aWNvfGpwZWd8anBnfGpzfHBuZykkIHsKICAgICAgICBleHBpcmVzIG1heDsKICAgICAgICBsb2dfbm90X2ZvdW5kIG9mZjsKICAgIH0KfQoKIyBzZXJ2ZXIgewojICAgICBsaXN0ZW4gNDQzIHNzbCBodHRwMjsKIyAgICAgbGlzdGVuIFs6Ol06NDQzIHNzbCBodHRwMjsKCiMgICAgIHNzbF9jZXJ0aWZpY2F0ZSAvcGF0aC90by9zaWduZWRfY2VydF9wbHVzX2ludGVybWVkaWF0ZXM7CiMgICAgIHNzbF9jZXJ0aWZpY2F0ZV9rZXkgL3BhdGgvdG8vcHJpdmF0ZV9rZXk7CiMgICAgIHNzbF9zZXNzaW9uX3RpbWVvdXQgMWQ7CiMgICAgIHNzbF9zZXNzaW9uX2NhY2hlIHNoYXJlZDpNb3pTU0w6MTBtOyAgIyBhYm91dCA0MDAwMCBzZXNzaW9ucwojICAgICBzc2xfc2Vzc2lvbl90aWNrZXRzIG9mZjsKCiMgICAgICMgY3VybCBodHRwczovL3NzbC1jb25maWcubW96aWxsYS5vcmcvZmZkaGUyMDQ4LnR4dCA+IC9wYXRoL3RvL2RocGFyYW0KIyAgICAgc3NsX2RocGFyYW0gL3BhdGgvdG8vZGhwYXJhbTsKCiMgICAgICMgaW50ZXJtZWRpYXRlIGNvbmZpZ3VyYXRpb24KIyAgICAgc3NsX3Byb3RvY29scyBUTFN2MS4yIFRMU3YxLjM7CiMgICAgIHNzbF9jaXBoZXJzIEVDREhFLUVDRFNBLUFFUzEyOC1HQ00tU0hBMjU2OkVDREhFLVJTQS1BRVMxMjgtR0NNLVNIQTI1NjpFQ0RIRS1FQ0RTQS1BRVMyNTYtR0NNLVNIQTM4NDpFQ0RIRS1SU0EtQUVTMjU2LUdDTS1TSEEzODQ6RUNESEUtRUNEU0EtQ0hBQ0hBMjAtUE9MWTEzMDU6RUNESEUtUlNBLUNIQUNIQTIwLVBPTFkxMzA1OkRIRS1SU0EtQUVTMTI4LUdDTS1TSEEyNTY6REhFLVJTQS1BRVMyNTYtR0NNLVNIQTM4NDpESEUtUlNBLUNIQUNIQTIwLVBPTFkxMzA1OwojICAgICBzc2xfcHJlZmVyX3NlcnZlcl9jaXBoZXJzIG9mZjsKCiMgICAgICMgSFNUUyAobmd4X2h0dHBfaGVhZGVyc19tb2R1bGUgaXMgcmVxdWlyZWQpICg2MzA3MjAwMCBzZWNvbmRzKQojICAgICBhZGRfaGVhZGVyIFN0cmljdC1UcmFuc3BvcnQtU2VjdXJpdHkgIm1heC1hZ2U9NjMwNzIwMDAiIGFsd2F5czsKCiMgICAgICMgT0NTUCBzdGFwbGluZwojICAgICBzc2xfc3RhcGxpbmcgb247CiMgICAgIHNzbF9zdGFwbGluZ192ZXJpZnkgb247CgojICAgICAjIHZlcmlmeSBjaGFpbiBvZiB0cnVzdCBvZiBPQ1NQIHJlc3BvbnNlIHVzaW5nIFJvb3QgQ0EgYW5kIEludGVybWVkaWF0ZSBjZXJ0cwojICAgICBzc2xfdHJ1c3RlZF9jZXJ0aWZpY2F0ZSAvcGF0aC90by9yb290X0NBX2NlcnRfcGx1c19pbnRlcm1lZGlhdGVzOwoKIyAgICAgIyByZXBsYWNlIHdpdGggdGhlIElQIGFkZHJlc3Mgb2YgeW91ciByZXNvbHZlcgojICAgICByZXNvbHZlciAxMjcuMC4wLjE7CiN9IiA+IC9ldGMvbmdpbngvc2l0ZXMtYXZhaWxhYmxlLyRET01BSU5fT1JfREVGQVVMVApsbiAtcyAvZXRjL25naW54L3NpdGVzLWF2YWlsYWJsZS8kRE9NQUlOX09SX0RFRkFVTFQgL2V0Yy9uZ2lueC9zaXRlcy1lbmFibGVkLyRET01BSU5fT1JfREVGQVVMVCB8fCB0cnVlCm5naW54IC10CnN5c3RlbWN0bCByZWxvYWQgbmdpbngKCiMgSW5zdGFsbCB3b3JkcHJlc3MKcm0gLXJmIC92YXIvd3d3L2h0bWwvKgp3Z2V0IC1QIC90bXAvIGh0dHBzOi8vd29yZHByZXNzLm9yZy9sYXRlc3QuemlwCnVuemlwIC90bXAvbGF0ZXN0LnppcCAtZCAvdG1wCm12IC90bXAvd29yZHByZXNzLyogL3Zhci93d3cvJERPTUFJTl9PUl9OT05FCgojIEZpeCBmb2xkZXIgcGVybWlzc2lvbnMKY2htb2QgNzU1IC1SIC92YXIvd3d3LwpjaG93biB3d3ctZGF0YTp3d3ctZGF0YSAtUiAvdmFyL3d3dy8=
runcmd:
  - cp /etc/skel/.bashrc /home/drew/.profile
  - sed -i 's/#force_color_prompt=yes/force_color_prompt=yes/g' /home/drew/.profile
  - chown drew:drew /home/drew/.profile
  - systemctl restart ssh
  - /etc/lemp-install.sh
