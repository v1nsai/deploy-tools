#cloud-config
package_update: true
packages:
  - bash-completion
  - unzip
users:
  - name: drew
    sudo: ['ALL=(ALL) NOPASSWD:ALL']
    groups: [sudo, www-data]
    shell: /bin/bash
    lock_passwd: false
    passwd: $6$rounds=4096$nQEeaHtrjiUlxOPi$LQlgi0XBR6u46AJFhWxsWBBK8YqHbGWYWkWnG.YhmdYkc/lMiAacMwQAbZ0W7MosLFexushHQpfa05eG7gsL/1
    ssh-authorized-keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCX3ZnnojSpqi1R7CWmP7uVFU2fEd2uS4PYQpWC23ScmDGP7KFHeTJfMc6eMaAhbxfIXx2CFdsIhP5U58BFLmAxkUIM8lGnHgh1uME/aOMZokZrDhYnw0eaamVOg0rdKD/uaTo87ASoxpf0XYnrqcrYhFIQodxjsCC8pCU5Egjh9QDgHsniJ5vWEkxZGPQ4SXIj4txh8uXMI0mh57BWJRK0zJIDzZCxubtrOpWoQnVvg/ZV+Thgy0P9m7e8OHbaM3U/7p4DBd1MZ95jNwjefMeD5hR46T35rkR9w/ebEIKhGjz0UB2yRUZPOPqBzVfixYA6gfd5c1AhjluCyCqhLEMd Generated-by-Nova
  - name: wordpress
    sudo: false
    groups: [www-data]
    shell: /bin/bash
    lock_passwd: false
write_files:
  - path: "/etc/environment"
    content: "ZXhwb3J0IFBBU1NfTVlTUUxfUk9PVD0KZXhwb3J0IFBBU1NfTVlTUUxfV1BfVVNFUj0KZXhwb3J0IFBBU1NfV09SRFBSRVNTPQo="
    encoding: base64
    append: true
  - path: "/etc/ssh/sshd_config"
    content: "UG9ydCAxMzU1ClBlcm1pdFJvb3RMb2dpbiBubwpQYXNzd29yZEF1dGhlbnRpY2F0aW9uIHllcwo="
    append: true
    encoding: base64
  - path: "/etc/lemp-install.sh"
    encoding: base64
    permissions: "700"
    content: IyEvYmluL2Jhc2gKCnNldCAtZQoKRE9NQUlOPSJkZWZhdWx0IgoKIyBJbnN0YWxsIHBhY2thZ2VzCmFwdCB1cGRhdGUgfHwgdHJ1ZQphcHQgaW5zdGFsbCAteSBuZ2lueCBtYXJpYWRiLXNlcnZlciBwaHAtZnBtIHBocC1teXNxbCBwaHAtY3VybCBwaHAtZ2QgcGhwLWludGwgcGhwLW1ic3RyaW5nIHBocC1zb2FwIHBocC14bWwgcGhwLXhtbHJwYyBwaHAtemlwCgojIENvbmZpZ3VyZSBtYXJpYWRiCmRlYmNvbmYtc2V0LXNlbGVjdGlvbnMgPDw8ICJteXNxbC1zZXJ2ZXIgbXlzcWwtc2VydmVyL3Jvb3RfcGFzc3dvcmQgcGFzc3dvcmQgJHtQQVNTX01ZU1FMX1JPT1R9IiAjIG5ldyBwYXNzd29yZCBmb3IgdGhlIE15U1FMIHJvb3QgdXNlcgpkZWJjb25mLXNldC1zZWxlY3Rpb25zIDw8PCAibXlzcWwtc2VydmVyIG15c3FsLXNlcnZlci9yb290X3Bhc3N3b3JkX2FnYWluIHBhc3N3b3JkICR7UEFTU19NWVNRTF9ST09UfSIgIyByZXBlYXQgcGFzc3dvcmQgZm9yIHRoZSBNeVNRTCByb290IHVzZXIKCm15c3FsIC0tdXNlcj1yb290IC0tcGFzc3dvcmQ9JHtQQVNTX01ZU1FMX1JPT1R9IDw8IEVPRk1ZU1FMU0VDVVJFCkRFTEVURSBGUk9NIG15c3FsLnVzZXIgV0hFUkUgVXNlcj0ncm9vdCcgQU5EIEhvc3QgTk9UIElOICgnbG9jYWxob3N0JywgJzEyNy4wLjAuMScsICc6OjEnKTsKREVMRVRFIEZST00gbXlzcWwudXNlciBXSEVSRSBVc2VyPScnOwpERUxFVEUgRlJPTSBteXNxbC5kYiBXSEVSRSBEYj0ndGVzdCcgT1IgRGI9J3Rlc3RfJSc7CkZMVVNIIFBSSVZJTEVHRVM7CkVPRk1ZU1FMU0VDVVJFCm15c3FsIC11IHJvb3QgLXAgLWUgIkNSRUFURSBVU0VSICd3cF91c2VyJ0AnbG9jYWxob3N0JyBJREVOVElGSUVEIEJZICcke1BBU1NfTVlTUUxfV1BfVVNFUn0nOyIKCiMgQ29uZmlndXJlIG5naW54Cm1rZGlyIC92YXIvd3d3LyRET01BSU4gCmNob3duIC1SIHdvcmRwcmVzczp3b3JkcHJlc3MgL3Zhci93d3cvJERPTUFJTgp0b3VjaCAvZXRjL25naW54L3NpdGVzLWF2YWlsYWJsZS8kRE9NQUlOCmVjaG8gIiMgZ2VuZXJhdGVkIDIwMjMtMDUtMjksIE1vemlsbGEgR3VpZGVsaW5lIHY1LjcsIG5naW54IDEuMTcuNywgT3BlblNTTCAxLjEuMWssIGludGVybWVkaWF0ZSBjb25maWd1cmF0aW9uCiMgaHR0cHM6Ly9zc2wtY29uZmlnLm1vemlsbGEub3JnLyNzZXJ2ZXI9bmdpbngmdmVyc2lvbj0xLjE3LjcmY29uZmlnPWludGVybWVkaWF0ZSZvcGVuc3NsPTEuMS4xayZndWlkZWxpbmU9NS43CnNlcnZlciB7CiAgICBsaXN0ZW4gODA7CiAgICBsaXN0ZW4gWzo6XTo4MDsKCiAgICByb290IC92YXIvd3d3LyRET01BSU47CiAgICBpbmRleCBpbmRleC5waHAgaW5kZXguaHRtbCBpbmRleC5odG07CgogICAgc2VydmVyX25hbWUgJERPTUFJTjsKCiAgICBsb2NhdGlvbiAvIHsKICAgICAgICAjIHRyeV9maWxlcyAkdXJpICR1cmkvID00MDQ7CiAgICAgICAgdHJ5X2ZpbGVzICR1cmkgJHVyaS8gL2luZGV4LnBocCRpc19hcmdzJGFyZ3M7CiAgICB9CgogICAgbG9jYXRpb24gfiBcLnBocCQgewogICAgICAgIGluY2x1ZGUgc25pcHBldHMvZmFzdGNnaS1waHAuY29uZjsKICAgICAgICBmYXN0Y2dpX3Bhc3MgdW5peDovdmFyL3J1bi9waHAvcGhwNy40LWZwbS5zb2NrOwogICAgfQoKICAgICMgRGlnaXRhbG9jZWFuIHdvcmRwcmVzcwogICAgbG9jYXRpb24gPSAvZmF2aWNvbi5pY28geyBsb2dfbm90X2ZvdW5kIG9mZjsgYWNjZXNzX2xvZyBvZmY7IH0KICAgIGxvY2F0aW9uID0gL3JvYm90cy50eHQgeyBsb2dfbm90X2ZvdW5kIG9mZjsgYWNjZXNzX2xvZyBvZmY7IGFsbG93IGFsbDsgfQogICAgbG9jYXRpb24gfiogXC4oY3NzfGdpZnxpY298anBlZ3xqcGd8anN8cG5nKSQgewogICAgICAgIGV4cGlyZXMgbWF4OwogICAgICAgIGxvZ19ub3RfZm91bmQgb2ZmOwogICAgfQp9CgoKc2VydmVyIHsKICAgIGxpc3RlbiA0NDMgc3NsIGh0dHAyOwogICAgbGlzdGVuIFs6Ol06NDQzIHNzbCBodHRwMjsKCiAgICBzc2xfY2VydGlmaWNhdGUgL3BhdGgvdG8vc2lnbmVkX2NlcnRfcGx1c19pbnRlcm1lZGlhdGVzOwogICAgc3NsX2NlcnRpZmljYXRlX2tleSAvcGF0aC90by9wcml2YXRlX2tleTsKICAgIHNzbF9zZXNzaW9uX3RpbWVvdXQgMWQ7CiAgICBzc2xfc2Vzc2lvbl9jYWNoZSBzaGFyZWQ6TW96U1NMOjEwbTsgICMgYWJvdXQgNDAwMDAgc2Vzc2lvbnMKICAgIHNzbF9zZXNzaW9uX3RpY2tldHMgb2ZmOwoKICAgICMgY3VybCBodHRwczovL3NzbC1jb25maWcubW96aWxsYS5vcmcvZmZkaGUyMDQ4LnR4dCA+IC9wYXRoL3RvL2RocGFyYW0KICAgIHNzbF9kaHBhcmFtIC9wYXRoL3RvL2RocGFyYW07CgogICAgIyBpbnRlcm1lZGlhdGUgY29uZmlndXJhdGlvbgogICAgc3NsX3Byb3RvY29scyBUTFN2MS4yIFRMU3YxLjM7CiAgICBzc2xfY2lwaGVycyBFQ0RIRS1FQ0RTQS1BRVMxMjgtR0NNLVNIQTI1NjpFQ0RIRS1SU0EtQUVTMTI4LUdDTS1TSEEyNTY6RUNESEUtRUNEU0EtQUVTMjU2LUdDTS1TSEEzODQ6RUNESEUtUlNBLUFFUzI1Ni1HQ00tU0hBMzg0OkVDREhFLUVDRFNBLUNIQUNIQTIwLVBPTFkxMzA1OkVDREhFLVJTQS1DSEFDSEEyMC1QT0xZMTMwNTpESEUtUlNBLUFFUzEyOC1HQ00tU0hBMjU2OkRIRS1SU0EtQUVTMjU2LUdDTS1TSEEzODQ6REhFLVJTQS1DSEFDSEEyMC1QT0xZMTMwNTsKICAgIHNzbF9wcmVmZXJfc2VydmVyX2NpcGhlcnMgb2ZmOwoKICAgICMgSFNUUyAobmd4X2h0dHBfaGVhZGVyc19tb2R1bGUgaXMgcmVxdWlyZWQpICg2MzA3MjAwMCBzZWNvbmRzKQogICAgYWRkX2hlYWRlciBTdHJpY3QtVHJhbnNwb3J0LVNlY3VyaXR5ICJtYXgtYWdlPTYzMDcyMDAwIiBhbHdheXM7CgogICAgIyBPQ1NQIHN0YXBsaW5nCiAgICBzc2xfc3RhcGxpbmcgb247CiAgICBzc2xfc3RhcGxpbmdfdmVyaWZ5IG9uOwoKICAgICMgdmVyaWZ5IGNoYWluIG9mIHRydXN0IG9mIE9DU1AgcmVzcG9uc2UgdXNpbmcgUm9vdCBDQSBhbmQgSW50ZXJtZWRpYXRlIGNlcnRzCiAgICBzc2xfdHJ1c3RlZF9jZXJ0aWZpY2F0ZSAvcGF0aC90by9yb290X0NBX2NlcnRfcGx1c19pbnRlcm1lZGlhdGVzOwoKICAgICMgcmVwbGFjZSB3aXRoIHRoZSBJUCBhZGRyZXNzIG9mIHlvdXIgcmVzb2x2ZXIKICAgIHJlc29sdmVyIDEyNy4wLjAuMTsKfSIgPiAvZXRjL25naW54L3NpdGVzLWF2YWlsYWJsZS8kRE9NQUlOCmxuIC1zIC9ldGMvbmdpbngvc2l0ZXMtYXZhaWxhYmxlLyRET01BSU4gL2V0Yy9uZ2lueC9zaXRlcy1lbmFibGVkLyRET01BSU4gfHwgdHJ1ZSAjVE9ETyBtYWtlIHN1cmUgdGhpcyBpc24ndCBhIGJhZCBpZGVhCm5naW54IC10CnN5c3RlbWN0bCByZWxvYWQgbmdpbngKCiMgSW5zdGFsbCB3b3JkcHJlc3MKcm0gLXJmIC92YXIvd3d3L2h0bWwvLioKd2dldCAtUCAvaG9tZS93b3JkcHJlc3MgaHR0cHM6Ly93b3JkcHJlc3Mub3JnL2xhdGVzdC56aXAKdW56aXAgL2hvbWUvd29yZHByZXNzL2xhdGVzdC56aXAgLWQgL3Jvb3QvCm12IC9yb290L3dvcmRwcmVzcy8uKiAvdmFyL3d3dy8kRE9NQUlOLwoKIyBGaXggZm9sZGVyIHBlcm1pc3Npb25zCmNobW9kIDc1NSAtUiAvdmFyL3d3dy8KY2hvd24gd29yZHByZXNzOnd3dy1kYXRhIC1SIC92YXIvd3d3Lw==
runcmd:
  - cp /etc/skel/.bashrc /home/drew/.profile
  - sed -i 's/#force_color_prompt=yes/force_color_prompt=yes/g' /home/drew/.profile
  - chown drew:drew /home/drew/.profile
  - systemctl restart ssh
  - /etc/lemp-install.sh
