#cloud-config
ssh_pwauth: true
users:
  - name: root
    lock_passwd: false
    hashed_passwd: $6$rounds=4096$s0cBOA5fV0NQT3a7$x1/wtO50h8UjYX.AuEN1qxr9z4Tw7.bhW/DeGY1z8ZtPmS245FkezDAogv1/ZxLfazSING3H0qW2z6qXeDPkH0
    ssh_authorized_keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCX3ZnnojSpqi1R7CWmP7uVFU2fEd2uS4PYQpWC23ScmDGP7KFHeTJfMc6eMaAhbxfIXx2CFdsIhP5U58BFLmAxkUIM8lGnHgh1uME/aOMZokZrDhYnw0eaamVOg0rdKD/uaTo87ASoxpf0XYnrqcrYhFIQodxjsCC8pCU5Egjh9QDgHsniJ5vWEkxZGPQ4SXIj4txh8uXMI0mh57BWJRK0zJIDzZCxubtrOpWoQnVvg/ZV+Thgy0P9m7e8OHbaM3U/7p4DBd1MZ95jNwjefMeD5hR46T35rkR9w/ebEIKhGjz0UB2yRUZPOPqBzVfixYA6gfd5c1AhjluCyCqhLEMd Generated-by-Nova
  - name: localadmin
    sudo: ALL=(ALL) NOPASSWD:ALL
    groups: users, admin, sudo
    shell: /bin/bash
    lock_passwd: false
    passwd: $6$rounds=4096$nQEeaHtrjiUlxOPi$LQlgi0XBR6u46AJFhWxsWBBK8YqHbGWYWkWnG.YhmdYkc/lMiAacMwQAbZ0W7MosLFexushHQpfa05eG7gsL/1
    ssh_authorized_keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCX3ZnnojSpqi1R7CWmP7uVFU2fEd2uS4PYQpWC23ScmDGP7KFHeTJfMc6eMaAhbxfIXx2CFdsIhP5U58BFLmAxkUIM8lGnHgh1uME/aOMZokZrDhYnw0eaamVOg0rdKD/uaTo87ASoxpf0XYnrqcrYhFIQodxjsCC8pCU5Egjh9QDgHsniJ5vWEkxZGPQ4SXIj4txh8uXMI0mh57BWJRK0zJIDzZCxubtrOpWoQnVvg/ZV+Thgy0P9m7e8OHbaM3U/7p4DBd1MZ95jNwjefMeD5hR46T35rkR9w/ebEIKhGjz0UB2yRUZPOPqBzVfixYA6gfd5c1AhjluCyCqhLEMd Generated-by-Nova
  - name: wordpress
    groups: [www-data]
    shell: /bin/bash
    lock_passwd: false
    ssh_pwauth: true
    passwd: $6$rounds=4096$s0cBOA5fV0NQT3a7$x1/wtO50h8UjYX.AuEN1qxr9z4Tw7.bhW/DeGY1z8ZtPmS245FkezDAogv1/ZxLfazSING3H0qW2z6qXeDPkH0
apt:
  preserve_sources_list: true
package_update: false
write_files:
  - path: /etc/ssh/sshd_config
    content: |
      IyEvYmluL2Jhc2gKCnNldCAtZQoKVVNFUkRPTUFJTj1mYWxzZQppZiBbWyAkRE9NQUlOIF1dOyB0
      aGVuCiAgICBlY2hvICJTZXR0aW5nIERPTUFJTi4uLiIKICAgIFVTRVJET01BSU49dHJ1ZQplbHNl
      CiAgICBlY2hvICJET01BSU4gbm90IHNldCwgZGVmYXVsdGluZyB0byBwdWJsaWMgSVAiCiAgICBE
      T01BSU49IiQoY3VybCAtcyBodHRwOi8vd2hhdGlzbXlpcC5ha2FtYWkuY29tLykiCmZpCgpzdWRv
      IG1rZGlyIC1wIC9vcHQvd3AtZGVwbG95CnN1ZG8gY2hvd24gLVIgbG9jYWxhZG1pbjpsb2NhbGFk
      bWluIC9vcHQvd3AtZGVwbG95CmNkIC9vcHQvd3AtZGVwbG95CiMgc3VkbyBhcHQgdXBkYXRlCiMg
      c3VkbyBhcHQgaW5zdGFsbCAteSBweXRob24zIHB5dGhvbjMtcGlwIHB5dGhvbjMtdmVudgojIHNs
      ZWVwIDYwCgojIEluc3RhbGwgZGVwZW5kZW5jaWVzCmN1cmwgLXNMIGh0dHBzOi8vcm9vdHMuaW8v
      dHJlbGxpcy9jbGkvZ2V0IHwgc3VkbyBiYXNoCnB5dGhvbjMgLW0gcGlwIGluc3RhbGwgdmlydHVh
      bGVudiBhbnNpYmxlCiMgL2hvbWUvbG9jYWxhZG1pbi8ubG9jYWwvYmluL2Fuc2libGUtZ2FsYXh5
      IGluc3RhbGwga3dvb2Rzb24ueWVkaXQKc3VkbyB3Z2V0IGh0dHBzOi8vZ2l0aHViLmNvbS9taWtl
      ZmFyYWgveXEvcmVsZWFzZXMvbGF0ZXN0L2Rvd25sb2FkL3lxX2xpbnV4X2FtZDY0IC1PIC91c3Iv
      YmluL3lxICYmXAogICAgc3VkbyBjaG1vZCAreCAvdXNyL2Jpbi95cQoKIyBDb25maWd1cmUgdXNl
      cnMKdHJlbGxpcyBuZXcgLS1uYW1lICRET01BSU4gLS1ob3N0ICRET01BSU4gJERPTUFJTiB8fCBl
      Y2hvICJEb21haW4gYWxyZWFkeSBleGlzdHMsIHNraXBwaW5nIG5ldyB3ZWJzaXRlIGNyZWF0aW9u
      Igp5cSAtaSAnLndlYl91c2VyID0gIndvcmRwcmVzcyInICRET01BSU4vdHJlbGxpcy9ncm91cF92
      YXJzL2FsbC91c2Vycy55bWwKeXEgLWkgJy5hZG1pbl91c2VyID0gImxvY2FsYWRtaW4iJyAkRE9N
      QUlOL3RyZWxsaXMvZ3JvdXBfdmFycy9hbGwvdXNlcnMueW1sCgojIENvbmZpZ3VyZSB3b3JkcHJl
      c3Nfc2l0ZXMKc2VkIC1pICdzL2V4YW1wbGVcLmNvbS8nJERPTUFJTicvZycgJERPTUFJTi90cmVs
      bGlzL2dyb3VwX3ZhcnMvcHJvZHVjdGlvbi93b3JkcHJlc3Nfc2l0ZXMueW1sCnlxIC1pICcud29y
      ZHByZXNzX3NpdGVzLiInJERPTUFJTiciLnJlcG8gPSAiZ2l0QGdpdGh1Yi5jb206cm9vdHMvYmVk
      cm9jay5naXQiJyAkRE9NQUlOL3RyZWxsaXMvZ3JvdXBfdmFycy9wcm9kdWN0aW9uL3dvcmRwcmVz
      c19zaXRlcy55bWwKc2VkIC1pICcvcmVwb19zdWJ0cmVlX3BhdGgvIHMvLiovLycgJERPTUFJTi90
      cmVsbGlzL2dyb3VwX3ZhcnMvcHJvZHVjdGlvbi93b3JkcHJlc3Nfc2l0ZXMueW1sCgojIFNTTCBj
      b25maWcKY2FzZSAkU1NMX1BST1ZJU0lPTkVSIGluCiAgICAibGV0c2VuY3J5cHQiKQogICAgICAg
      IGVjaG8gIlNldHRpbmcgdXAgbGV0c2VuY3J5cHQuLi4iCiAgICAgICAgeXEgLWkgJy53b3JkcHJl
      c3Nfc2l0ZXMuIickRE9NQUlOJyIuc3NsLmVuYWJsZWQgPSB0cnVlJyAkRE9NQUlOL3RyZWxsaXMv
      Z3JvdXBfdmFycy9wcm9kdWN0aW9uL3dvcmRwcmVzc19zaXRlcy55bWwKICAgICAgICB5cSAtaSAn
      LndvcmRwcmVzc19zaXRlcy4iJyRET01BSU4nIi5zc2wucHJvdmlkZXIgPSAibGV0c2VuY3J5cHQi
      JyAkRE9NQUlOL3RyZWxsaXMvZ3JvdXBfdmFycy9wcm9kdWN0aW9uL3dvcmRwcmVzc19zaXRlcy55
      bWwKICAgICAgICA7OwogICAgIm1hbnVhbCIpCiAgICAgICAgZWNobyAiU2V0dGluZyB1cCBtYW51
      YWwgU1NMLi4uIgogICAgICAgIHNlZCAtaSAnL3NzbDovLC9sZXRzZW5jcnlwdC9jXCAgICBzc2w6
      XG4gICAgICBlbmFibGVkOiB0cnVlXG4gICAgICBwcm92aWRlcjogbWFudWFsXG4gICAgICBjZXJ0
      OiAvZXRjL3NzbC5jcnRcbiAgICAgIGtleTogL2V0Yy9zc2wua2V5JyAkRE9NQUlOL3RyZWxsaXMv
      Z3JvdXBfdmFycy9wcm9kdWN0aW9uL3dvcmRwcmVzc19zaXRlcy55bWwKICAgICAgICA7OwogICAg
      InNlbGYtc2lnbmVkIikKICAgICAgICBlY2hvICJTZXR0aW5nIHVwIHNlbGYtc2lnbmVkIFNTTC4u
      LiIKICAgICAgICB5cSAtaSAnLndvcmRwcmVzc19zaXRlcy4iJyRET01BSU4nIi5zc2wuZW5hYmxl
      ZCA9IHRydWUnICRET01BSU4vdHJlbGxpcy9ncm91cF92YXJzL3Byb2R1Y3Rpb24vd29yZHByZXNz
      X3NpdGVzLnltbAogICAgICAgIHlxIC1pICcud29yZHByZXNzX3NpdGVzLiInJERPTUFJTiciLnNz
      bC5wcm92aWRlciA9ICJzZWxmLXNpZ25lZCInICRET01BSU4vdHJlbGxpcy9ncm91cF92YXJzL3By
      b2R1Y3Rpb24vd29yZHByZXNzX3NpdGVzLnltbAogICAgICAgIDs7CiAgICAqKQogICAgICAgIGVj
      aG8gIlNTTF9QUk9WSVNJT05FUiBub3Qgc2V0LCBkZWZhdWx0aW5nIHRvIHNlbGYtc2lnbmVkIgog
      ICAgICAgIHlxIC1pICcud29yZHByZXNzX3NpdGVzLiInJERPTUFJTiciLnNzbC5lbmFibGVkID0g
      dHJ1ZScgJERPTUFJTi90cmVsbGlzL2dyb3VwX3ZhcnMvcHJvZHVjdGlvbi93b3JkcHJlc3Nfc2l0
      ZXMueW1sCiAgICAgICAgeXEgLWkgJy53b3JkcHJlc3Nfc2l0ZXMuIickRE9NQUlOJyIuc3NsLnBy
      b3ZpZGVyID0gInNlbGYtc2lnbmVkIicgJERPTUFJTi90cmVsbGlzL2dyb3VwX3ZhcnMvcHJvZHVj
      dGlvbi93b3JkcHJlc3Nfc2l0ZXMueW1sCiAgICA7Owplc2FjCgojIENvbmZpZ3VyZSBob3N0cwpz
      ZWQgLWkgJ3MveW91cl9zZXJ2ZXJfaG9zdG5hbWUvMTI3LjAuMC4xL2cnICRET01BSU4vdHJlbGxp
      cy9ob3N0cy9wcm9kdWN0aW9uCgojIEFkZCBhbGwgcHVia2V5cyB0byB0aGUgYXV0aG9yaXplZF9r
      ZXlzIGZpbGUgZm9yIHByaXZpbGVnZWQgYW5kIG5vbiBwcml2aWxlZ2VkIHVzZXJzCiMgcm0gLXJm
      IC9ob21lL2xvY2FsYWRtaW4vLnNzaC9pZF9yc2EqCiMgc3VkbyBzc2gta2V5Z2VuIC10IHJzYSAt
      ZiAvcm9vdC8uc3NoL2lkX3JzYSAtUCAiIiAtYiA0MDk2CnN1ZG8gY3AgLWYgL2hvbWUvbG9jYWxh
      ZG1pbi8uc3NoLyogL3Jvb3QvLnNzaC8Kc3VkbyBta2RpciAtcCAvaG9tZS93b3JkcHJlc3MvLnNz
      aApjYXQgL2hvbWUvbG9jYWxhZG1pbi8uc3NoLyoucHViIHwgc3VkbyB0ZWUgLWEgL2hvbWUvbG9j
      YWxhZG1pbi8uc3NoL2F1dGhvcml6ZWRfa2V5cwpjaG1vZCA2MDAgL2hvbWUvbG9jYWxhZG1pbi8u
      c3NoL2lkX3JzYQpzdWRvIGNwIC9ob21lL2xvY2FsYWRtaW4vLnNzaC8qIC9ob21lL3dvcmRwcmVz
      cy8uc3NoLwpzdWRvIGNwIC9ob21lL2xvY2FsYWRtaW4vLnNzaC8qIC9yb290Ly5zc2gvCnN1ZG8g
      Y2hvd24gd29yZHByZXNzOndvcmRwcmVzcyAtUiAvaG9tZS93b3JkcHJlc3MvLnNzaC8Kc3VkbyBj
      aG93biBsb2NhbGFkbWluOmxvY2FsYWRtaW4gLVIgL2hvbWUvbG9jYWxhZG1pbi8uc3NoLwoKIyBD
      b25maWd1cmUgYWNjZXNzCmlmIFsgJFVTRVJET01BSU4gPSB0cnVlXSA7IHRoZW4KICAgIGVjaG8g
      J2xldHNlbmNyeXB0X2NvbnRhY3RfZW1haWxzOiBbICJtYWlsQCckRE9NQUlOJyIgXScgPj4gJERP
      TUFJTi90cmVsbGlzL2dyb3VwX3ZhcnMvYWxsL21haW4ueW1sCmVsc2UKICAgIGVjaG8gJ2xldHNl
      bmNyeXB0X2NvbnRhY3RfZW1haWxzOiBbICJtYWlsQHlvdXJkb21haW4uY29tIiBdJyA+PiAkRE9N
      QUlOL3RyZWxsaXMvZ3JvdXBfdmFycy9hbGwvbWFpbi55bWwKZmkKZWNobyAnaXBfd2hpdGVsaXN0
      OiBbICIwLjAuMC4wIiBdJyA+PiAkRE9NQUlOL3RyZWxsaXMvZ3JvdXBfdmFycy9hbGwvbWFpbi55
      bWwKZWNobyAnc3NoX2NsaWVudF9pcF9sb29rdXA6IGZhbHNlJyA+PiAkRE9NQUlOL3RyZWxsaXMv
      Z3JvdXBfdmFycy9hbGwvbWFpbi55bWwKCiMgUmFpc2UgaXBpZnkgdGltZW91dApzZWQgLWkgJ3Mv
      aXBpZnlfZmFjdHM6L2lwaWZ5X2ZhY3RzOlxuICAgICAgICB0aW1lb3V0OiA2MC9nJyAkRE9NQUlO
      L3RyZWxsaXMvcm9sZXMvY29tbW9uL3Rhc2tzL21haW4ueW1sCgojIFByb3Zpc2lvbiBhbmQgZGVw
      bG95IHRvIGxvY2FsaG9zdApjZCAkRE9NQUlOL3RyZWxsaXMKdHJlbGxpcyBwcm92aXNpb24gcHJv
      ZHVjdGlvbgp0cmVsbGlzIGRlcGxveSBwcm9kdWN0aW9uCgojIERpc2FibGUgcm9vdCBsb2dpbiBu
      b3cgdGhhdCB0cmVsbGlzIGhhcyBmaW5pc2hlZAplY2hvIC1uICJQZXJtaXRSb290TG9naW4gbm8i
      IHwgc3VkbyB0ZWUgLWEgL2V0Yy9zc2gvc3NoZF9jb25maWc=
    append: true
  - path: /home/localadmin/.ssh/config
    content: |
      Host 127.0.0.1 localhost
        StrictHostKeyChecking no

      Host github.com
        User git
        HostName github.com
        IdentityFile ~/.ssh/id_rsa
        StrictHostKeyChecking no
    owner: localadmin:localadmin
    permissions: '0600'
    defer: true
  - path: /home/wordpress/.ssh/authorized_keys
    content: |
      ${data.local_file.ssh-pubkey.content}
    owner: wordpress:wordpress
    permissions: '0600'
    append: true
    defer: true
  - path: /etc/crontab
    content: |
      30 23   * * *   root    /usr/sbin/shutdown -h
    append: true
    defer: true
